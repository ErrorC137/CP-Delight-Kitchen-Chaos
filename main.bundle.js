"use strict";(self.webpackChunkkitchen_chaos=self.webpackChunkkitchen_chaos||[]).push([[792],{214:(e,t,i)=>{var r=i(440),n=i.n(r);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function l(e,t,i){return t&&c(e.prototype,t),i&&c(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t){if(t&&("object"==s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(y=function(){return!!e})()}var p=function(e){function t(){return o(this,t),e=this,r=[{key:"Boot"}],i=h(i=t),u(e,y()?Reflect.construct(i,r||[],h(e).constructor):i.apply(e,r));var e,i,r}return f(t,e),l(t,[{key:"preload",value:function(){var e=this;this.load.setBaseURL("./assets/"),this.createLoadingScreen(),this.load.on("loaderror",(function(t){console.error("Failed to load asset: ".concat(t.key)),e.handleLoadError(t)})),this.loadAssets()}},{key:"createLoadingScreen",value:function(){var e=this.sys.game.config,t=e.width,i=e.height;this.add.text(t/2,i/2-40,"Loading Kitchen...",{font:"24px Arial",fill:"#ffffff"}).setOrigin(.5),this.add.rectangle(t/2,i/2+25,320,30,2236962,.8).setOrigin(.5);var r=this.add.rectangle(t/2-150,i/2+25,0,30,16777215).setOrigin(0,.5);this.load.on("progress",(function(e){r.width=300*e}))}},{key:"loadAssets",value:function(){this.load.image("kitchen_tiles","sprites/kitchen/kitchen_tiles.png"),this.load.tilemapTiledJSON("level1","config/level1.json"),this.load.spritesheet("player","sprites/chefs/chef_red.png",{frameWidth:32,frameHeight:32}),this.load.image("counter","sprites/kitchen/counter.png"),this.load.image("fryer","sprites/kitchen/appliance_fryer.png"),this.load.image("ingredient_chicken","sprites/kitchen/ingredient_chicken.png"),this.load.image("order_ticket","sprites/ui/order_ticket.png"),this.load.image("timer_bg","sprites/ui/timer_background.png"),this.load.audio("bell","audio/sfx/bell.mp3"),this.load.audio("sizzle","audio/sfx/sizzle.mp3"),this.load.spritesheet("fire","sprites/kitchen/kitchen_tiles.png",{frameWidth:32,frameHeight:32})}},{key:"create",value:function(){this.createAnimations(),this.scene.start("Kitchen"),this.scene.launch("HUD")}},{key:"createAnimations",value:function(){this.anims.create({key:"player_walk",frames:this.anims.generateFrameNumbers("player",{start:0,end:3}),frameRate:10,repeat:-1}),this.anims.create({key:"fire_anim",frames:this.anims.generateFrameNumbers("fire",{start:0,end:3}),frameRate:6,repeat:-1})}},{key:"handleLoadError",value:function(e){console.warn("Falling back: ".concat(e.key," (").concat(e.type,")")),"image"===e.type&&this.textures.addBase64(e.key,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=")}}])}(n().Scene);function k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(k=function(){return!!e})()}var g=function(e){function t(e,i,r,n){var s,a,c,l;return o(this,t),a=this,l=[e,i,r,n],c=h(c=t),s=u(a,k()?Reflect.construct(c,l||[],h(a).constructor):c.apply(a,l)),e.add.existing(s),e.physics.add.existing(s),s.type=n,s.isCooking=!1,s.progress=0,s}return f(t,e),l(t,[{key:"canCook",value:function(e){return{fryer:["chicken","fish"],oven:["dough","meat"],mixer:["lettuce","tomato"]}[this.type].includes(e.texture.key)}},{key:"startCooking",value:function(e){var t=this;this.isCooking=!0,this.scene.time.addEvent({delay:5e3,callback:function(){return t.finishCooking(e)},callbackScope:this})}},{key:"finishCooking",value:function(e){this.isCooking=!1,this.scene.add.sprite(this.x,this.y,"".concat(e.texture.key,"_cooked")).setData("value",2*e.getData("value"))}}])}(n().Physics.Arcade.Sprite);function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(m=function(){return!!e})()}var v=function(e){function t(e,i,r){var n,s,a,c;return o(this,t),s=this,c=[e,i,r,"player"],a=h(a=t),n=u(s,m()?Reflect.construct(a,c||[],h(s).constructor):a.apply(s,c)),e.add.existing(n),e.physics.add.existing(n),n.carrying=null,n.setCollideWorldBounds(!0),n.createAnimations(),n.setSize(16,16).setOffset(8,16),n}return f(t,e),l(t,[{key:"createAnimations",value:function(){this.anims.create({key:"walk",frames:this.anims.generateFrameNumbers("player",{start:0,end:3}),frameRate:10,repeat:-1})}},{key:"pickupItem",value:function(e){this.carrying||(this.carrying=e,e.setVisible(!1),this.scene.physics.world.disableBody(e.body))}},{key:"dropItem",value:function(){this.carrying&&(this.carrying.setVisible(!0),this.carrying.body.enable=!0,this.carrying=null)}},{key:"update",value:function(e){this.body.setVelocity(0),e.left.isDown?(this.body.setVelocityX(-160),this.anims.play("walk",!0),this.flipX=!0):e.right.isDown&&(this.body.setVelocityX(160),this.anims.play("walk",!0),this.flipX=!1),e.up.isDown?(this.body.setVelocityY(-160),this.anims.play("walk",!0)):e.down.isDown&&(this.body.setVelocityY(160),this.anims.play("walk",!0)),0===this.body.velocity.x&&0===this.body.velocity.y&&this.anims.stop()}}])}(n().Physics.Arcade.Sprite);function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}var w=function(e){function t(){var e,i,r,n;return o(this,t),i=this,n=["Kitchen"],r=h(r=t),(e=u(i,b()?Reflect.construct(r,n||[],h(i).constructor):r.apply(i,n))).orders=[],e.currentOrder=null,e.disasters=["earthquake","fire","flood","mouseInvasion"],e.timeBetweenOrders=45e3,e}return f(t,e),l(t,[{key:"preload",value:function(){this.load.tilemapTiledJSON("level1","assets/config/level1.json"),this.load.image("kitchen_tiles","assets/sprites/kitchen/kitchen_tiles.png"),this.load.image("counter","assets/sprites/kitchen/counter.png"),this.load.image("fryer","assets/sprites/kitchen/appliance_fryer.png"),this.load.image("chicken","assets/sprites/kitchen/ingredient_chicken.png"),this.load.spritesheet("player","assets/sprites/chefs/chef_red.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("fire","assets/sprites/kitchen/kitchen_tiles.png",{frameWidth:32,frameHeight:32})}},{key:"create",value:function(){this.createKitchenLayout(),this.player=new v(this,this.playerStart.x,this.playerStart.y),this.cursors=this.input.keyboard.createCursorKeys(),this.setupCookingStations(),this.setupOrders(),this.setupDisasters(),this.time.addEvent({delay:3e4,callback:this.increaseDifficulty,callbackScope:this,loop:!0})}},{key:"createKitchenLayout",value:function(){var e=this,t=this.make.tilemap({key:"level1"}),i=t.addTilesetImage("kitchen_tiles","kitchen_tiles");t.createLayer("Floor",i,0,0);var r=t.getObjectLayer("Objects");this.counters=this.physics.add.staticGroup(),r.objects.forEach((function(t){switch(t.type){case"spawn":e.playerStart={x:t.x,y:t.y};break;case"counter":e.counters.create(t.x,t.y,"counter").setOrigin(0);break;case"fryer":e.fryer=new g(e,t.x,t.y,"fryer");break;case"ingredient":e.add.image(t.x,t.y,"chicken").setOrigin(0);break;default:console.warn("Unknown object type:",t.type)}})),this.playerStart||(this.playerStart={x:100,y:100})}},{key:"update",value:function(){this.player&&this.cursors&&this.player.update(this.cursors)}},{key:"setupCookingStations",value:function(){this.fryer&&this.physics.add.overlap(this.player,this.fryer,(function(e,t){e.carrying&&t.canCook(e.carrying)&&(t.startCooking(e.carrying),e.dropItem())}))}},{key:"setupOrders",value:function(){var e=this;this.orderTimer=this.time.addEvent({delay:this.timeBetweenOrders,callback:function(){e.generateOrder(),e.orderTimer.delay=n().Math.Between(3e4,45e3)},loop:!0})}},{key:"setupDisasters",value:function(){this.disasterTimer=this.time.addEvent({delay:6e4,callback:this.triggerDisaster,callbackScope:this,loop:!0})}},{key:"generateOrder",value:function(){var e=this,t={friedChicken:["chicken","oil"],salad:["lettuce","tomato"],burger:["patty","bun","lettuce"]},i=Object.keys(t),r=i[n().Math.Between(0,i.length-1)];this.orders.push({recipe:r,ingredients:t[r],timer:this.time.delayedCall(3e4,(function(){return e.failOrder()}))}),this.registry.events.emit("updateorder",this.orders[this.orders.length-1])}},{key:"triggerDisaster",value:function(){var e=this,t=n().Math.RND.pick(this.disasters);switch(t){case"earthquake":this.cameras.main.shake(3e3,.02),this.time.addEvent({delay:100,callback:function(){e.children.each((function(e){e.body&&(e.body.velocity.y+=n().Math.Between(-50,50))}))},repeat:30});break;case"fire":var i=this.add.sprite(n().Math.Between(100,700),n().Math.Between(100,500),"fire");i.setScale(1),i.play("fire_anim");break;default:console.warn("Disaster ".concat(t," not implemented."))}}},{key:"increaseDifficulty",value:function(){this.timeBetweenOrders*=.9,this.disasterTimer.delay*=.85,this.orderTimer.delay=n().Math.Clamp(this.orderTimer.delay,15e3,45e3)}},{key:"failOrder",value:function(){console.log("Order failed!")}}])}(n().Scene);function O(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(O=function(){return!!e})()}var A=function(){function e(){return o(this,e),t=this,r=["HUD"],i=h(i=e),u(t,O()?Reflect.construct(i,r||[],h(t).constructor):i.apply(t,r));var t,i,r}return f(e,Phaser.Scene),l(e,[{key:"create",value:function(){this.orderText=this.add.text(20,20,"Current Order:",{fontSize:"24px",fill:"#FFF"}),this.timerText=this.add.text(20,50,"Time Remaining:",{fontSize:"24px",fill:"#FFF"}),this.registry.events.on("updateorder",this.updateOrder,this)}},{key:"updateOrder",value:function(e){this.orderText.setText("Order: ".concat(e.recipe,"\nIngredients: ").concat(e.ingredients.join(", ")))}}])}(),S={type:n().AUTO,parent:"game-container",width:2048,height:1536,backgroundColor:"#000000",pixelArt:!0,physics:{default:"arcade",arcade:{debug:!1,gravity:{y:0}}},scale:{mode:n().Scale.FIT,autoCenter:n().Scale.CENTER_BOTH},scene:[p,w,A]},_=new(n().Game)(S);function C(e){try{var t=io("wss://your-game-server.com",{transports:["websocket"],secure:!0,reconnectionAttempts:5,timeout:1e4});e.registry.set("socket",t),t.on("connect",(function(){console.log("Socket connected");var t=e.scene.get("HUD");null!=t&&t.handleConnection&&t.handleConnection(!0)})),t.on("disconnect",(function(t){console.warn("Socket disconnected:",t);var i=e.scene.get("HUD");null!=i&&i.handleConnection&&i.handleConnection(!1)})),t.on("connect_error",(function(t){console.error("Socket error:",t.message);var i=e.scene.get("HUD");null!=i&&i.showNetworkError&&i.showNetworkError(t.message)})),e.events.once("destroy",(function(){t.disconnect(),e.registry.remove("socket")}))}catch(t){console.error("Socket.io init failed:",t);var i=e.scene.get("HUD");null!=i&&i.showNetworkError&&i.showNetworkError("Socket disabled")}}window.addEventListener("load",(function(){_.isBooted?C(_):_.events.once("boot",(function(){C(_)}))}))}},e=>{e.O(0,[418],(()=>e(e.s=214))),e.O()}]);